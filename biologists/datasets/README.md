#  Шаги для выполнения ДЗ:

## 1. Чем раньше, тем лучше, оставите напоследок, потом не жалуйтесь, что что-то не получается, я в танке.
* Пойти по [ссылке](https://docs.google.com/spreadsheets/d/1kYiVnP8zELs7YWCxPek_-VlITQD3a8g65t0k22SupO8/edit?usp=sharing) и заполнить поле фио.

* Спустя сутки после заполнения я напишу в поле "seq" ваш индекс-айди последовательности.
    
## 2.0 Это можете начать делать хоть на зачетной неделе.
* Пойти по [ссылке](https://github.com/Alteroldis/FEFU-bioinf/tree/master/biologists/datasets) и скачать 2 файла, которые там есть, кроме этого. Впрочем и этот можно, если хотите.
* И еще скачать [файл](https://drive.google.com/file/d/1PQStHQo0xpNoxFMK6x64qcesg0nrIMPR/view?usp=sharing), распаковав который получите `database.fa`. Весит архив 350МБ.

#### 2.1
* Выцепить из результатов blast (`efra2swiss.outfmt`) строки, в которых `qseqid` (*query sequence id*, столбец 1) совпадает с вашей `seqid` из гуглодока. Затем найти `sseqid` (*subject sequence id*, столбец 2) 10 белков, для которых будут выполнены 3 условия:

   1. Оценка выравнивания (*score*, столбец 14) с этими `sseqid` должна быть **больше**, чем у прочих `sseqid` для данного `qseqid`
   2. `sseqid` принадлежат **разным родам** Metazoa
   3. Из 10 выбранных `sseqid` ни один не должен повторятся

   ###### Пример:
   Допустим есть три индекса `i1, i2, i3` с оценками `s1-s3`, где `s1 > s2 > s3`. При этом *i1* и *i2* имеют *genus1*, а *i3* - *genus2*. Тогда остаться должны *только i1 и i3*, потому что хоть `s2 > s3`, но и *i1*, и *i2* из рода *genus1*, то есть сначала нужно будет среди этих двух выбрать тот индекс, что имеет больше `score`, а это *i1*.
    
 Cделать это можно просто. В первую очередь надо запарсить файл, создав из всех строк, включающих вашу `qseqid` список вида [[score1, genus1, index1], ... [scoreN, genusN, indexN]]. Затем, после сортировки списка, создать два множества, в один будете складывать искомые индексы, а в другой - индексы для каких родов уже сложили в первое множество. Наконец организовать по сортированному списку цикл `for`, в первую очередь проверяя, не было ли уже такого рода (пригодится функция `continue`), а затем запоминая с помощью двух множеств новый индекс и род. Параллельно в цикле можно сказать, что если `len(set_seqids) == 10: break`. То есть прервать цикл `for`, когда найдено уже 10 индексов. Не забывайте про порядок сортировки).

#### 2.2
* Найти в файле базы swissprot (`database`) отобранные в шаге 2.1 `sseqid` с помощью biopython. Файл в формате `fasta`, по сути представляет собой текстовый файл с кучей белковых последовательностей. Полученные `sseqid` надо будет привести к виду `genus.initial-sseqid.genename`.
    *ДОПОЛНЕНИЕ*: Не забывайте, что в [biopython](http://biopython.org/DIST/docs/tutorial/Tutorial.html) с помощью `seq.description` можно получить доступ к описанию последовательности, так вы легко сможете извлечь название белка и рода животного. **Если названия гена нет, то называйте ген как хотите, проявите фантазию)**. Не поленитесь и прочтите в мануале biopython главу 4, там опсание работы с объектом последовательности, в том числе поймете, что `sseqid` можно налету переименовать, еще при парсинге базы.
    Кроме того, файл database.fa сформирован с помощью повторов базы swissprot, потому в итоге вы получите 60 последовательностей. Получить уникальные можно обрезав ваш список последовательностей `list-with-seqs[:10]`. Запись в `fasta` файл также делается через biopython.
    ~~Да, я специально умножил базу, чтобы вы не ленились, выискивая все вручую в блокноте, а учились использовать специальные инструменты, так как если столкнетесь с подобной задачей, то последовательностей вряд ли будет всего 10.~~

#### 2.3
* Проверить на NCBI CDD для всех `seqs`, что ключевые для данного белка домены целые, если нет, то выбросить такую последовательность (да, такие будут, возможно не у всех).
* Добавить в полученный `your-seqs.fasta` последовательность из `seqs.fa`, индекс которой вы взяли в гуглодоке.

#### 2.4
* Сделать свой workflow на сайте [NGPhylogeny](https://ngphylogeny.fr/) — muscle, noisy, FastTree (бутстреп 1000) и запулить расчет с вашим `your-seqs.fasta` из шага 2.3. Итог мне.
    *ДОПОЛНЕНИЕ*: Пайплайн кастомный на сайте можно сделать, если найти фразу на французском).
